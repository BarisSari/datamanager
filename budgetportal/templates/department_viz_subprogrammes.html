{% load define_action %}

<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://viz.vulekamali.gov.za/main.css"/>
<link rel="stylesheet" href="https://viz.vulekamali.gov.za/treemap.css"/>

</style>
<!-- Load d3.js -->
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://viz.vulekamali.gov.za/utils.js"></script>

<button>Save as image</button>
<div id="my_dataviz"
     class="department-subprogramme-treemap"
     data-aggregate-url="{{ viz_data.get_aggregate_url }}"
     data-openspending-model="{{ viz_data.get_model | jsonify | escape }}"
     >
</div>

<script src="https://viz.vulekamali.gov.za/elements.js"></script>
<script src="https://viz.vulekamali.gov.za/openspending.js"></script>
<script src="https://viz.vulekamali.gov.za/vulekamali-openspending.js"></script>
<script src="https://viz.vulekamali.gov.za/dept-treemap.js"></script>
<script src="https://viz.vulekamali.gov.za/saveSvgAsPng.js"></script>

<script>
  d3.selectAll("button")
    .on("click", function() {
        svg = d3.selectAll("svg")
        saveSvgAsPng(svg.node(), "diagram.png");
    })
</script>
